<!DOCTYPE html>
<html>
	<!--
		2023-01-27T16:18:00 Created.
			resourceURI
				http://localhost/WordEngineering/WordUnion/Bible.json
				http://localhost/WordEngineering/WordUnion/BibleBook.json
		2023-01-27T17:18:00	http://elijahmanor.com/byte/js-locale-sort
		2023-01-27T17:18:00	http://stackoverflow.com/questions/37121301/how-to-check-if-the-response-of-a-fetch-is-a-json-object-in-javascript
		2023-01-28T09:53:00
		http://localhost/WordEngineering/Resume/KenAdenijiResume.txt
	-->
	<head>
		<title>Previous through?</title>
		<meta charset="UTF-8"/>
		<meta name="description" content="Previous through?"/>
		<meta name="keywords" content="fetch, .json, .txt, .xml"/>
		<meta name="robots" content="index, follow"/>
		<meta name="author" content="Ken Adeniji"/>
		<link rel="stylesheet" type="text/css" href="/WordEngineering/WordUnion/9432.css">
	</head>
	<body>
		<div align="center">
			<input 	id="command"
					style="width: 90vw;"
					value="sort"
					placeholder="command"
					autofocus
			/><br/>
			<input 	id="options"
					style="width: 90vw;"
					value="ScriptureReference"
					placeholder="options"
			/><br/>
			<input 	id="resourceURI" 
					type="url"
					style="width: 90vw;"
					value="http://localhost/WordEngineering/WordUnion/Bible.json"
					placeholder="resourceURI"
			/><br/>
			<input type="submit" id="submitQuery">
			<div id="resultSet" align="left"></div>
		</div>
		<script>
			var isPostBack = false;

			const commandElement = document.getElementById("command");
			const optionsElement = document.getElementById("options");			
			const resourceURIElement = document.getElementById("resourceURI");
			const submitQueryElement = document.getElementById("submitQuery");
			const resultSetElement = document.getElementById("resultSet");
			
			function pageLoad()
			{
				if (isPostBack === false)
				{
					isPostBack = true;
					querySubmit();
				}
			}

			function querySubmit()
			{
				fetch(resourceURIElement.value).then
				(
					response =>
					{
						const contentType = response.headers.get("content-type");
						console.log(contentType);
						if (contentType.indexOf("application/json") !== -1) 
						{
							response.json().then
							(
								data => 
								{
									// The response was a JSON object
									// Process your data as a JavaScript object
									// data.sort((a, b) => a[optionsElement.value].localeCompare(b[optionsElement.value]));
									resultSetElement.innerHTML = JSON.stringify(data);
								}
							);
							return;
						} 
						else if (contentType.indexOf("text/plain") !== -1) 
						{
							response.text().then
							(
								data => 
								{
									resultSetElement.innerHTML = 
										data.split("\n")
										.sort()
										.join("<br/>")
										;
								}
							);
							return;
						}
					}
				);
			}

		    window.addEventListener("load", pageLoad, false);

		    var body = document.getElementsByTagName('body')[0];
		    body.onkeydown = function (e) {
		        if (e.keyCode === 13) {  //enter key code
		            querySubmit();
		        }
		    }
			
			submitQueryElement.addEventListener("click", querySubmit, false);
		</script>
	</body>
</html>
