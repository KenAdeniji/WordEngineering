<!DOCTYPE html>
<html>
	<!--
		2016-06-24	No longer requires jQuery.
		2016-06-24	http://stackoverflow.com/questions/563406/add-days-to-datetime
	-->
	<head>
		<title>Date Add</title>
		<meta charset="UTF-8"/>
		<meta name="description" content="Increments or decrements days by a given value. It differs from DateAdd.aspx, in that it accepts Biblical metrics, like Biblical months and years."/>
		<meta name="keywords" content="Bible, datetime, add"/>
		<meta name="robots" content="index, follow"/>
		<meta name="author" content="Ken Adeniji"/>
		<link rel="stylesheet" type="text/css" href="9432.css">
	</head>
	<body>
		<div align="center">
			<table>
				<tr>
					<td><label for="currentDate">Date</label></td>
					<td><input id="currentDate" type="DateTime" /></td>
				</tr>
				<tr>
					<td><label for="metric">Metric</label></td>
					<td>
						<select id="metric">
							<option>Days</option>
							<option>Biblical months</option>
							<option>Biblical years</option>							
						</select>
					</td>
				</tr>
				<tr>
					<td><label for="difference">Difference</label></td>
					<td><input id="difference" type="text" columns="20" /></td>
				</tr>
				<tr>
					<td align="center" colspan="2"><input type="submit" id="submitQuery"></td>
				<tr>
				<tr>
					<td><label for="adjustedDate">Adjusted Date</label></td>
					<td><label id="adjustedDate"></td>
				</tr>
			</table>
		</div>
		<script>
/*
			function addDays(myDate,days) {
				return new Date(myDate.getTime() + days*24*60*60*1000);
			}
*/

function addDays(date, days) {
    var result = new Date(date);
    result.setDate(result.getDate() + days);
    return result;
}			
			function dateDifference()
			{
				var currentDate = new Date( document.getElementById("currentDate").value );
				var metric = document.getElementById("metric").value;
				var difference = parseFloat( document.getElementById("difference").value );

				var days = null;
				
				switch (metric)
				{
					case "Days":
						days = difference;
						break;

					case "Biblical months":
						days = difference * 30;
						break;
						
					case "Biblical years":
						days = difference * 360;
						break;
				}

				document.getElementById("adjustedDate").innerHTML = addDays(currentDate, days);
			}
			
			document.getElementById("submitQuery").addEventListener("click", dateDifference, false);
		</script>		
	</body>
</html>
