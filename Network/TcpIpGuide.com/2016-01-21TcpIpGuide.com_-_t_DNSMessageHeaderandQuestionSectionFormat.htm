<table border="1">
	<caption>
		<a href="http://tcpipguide.com/free/t_DNSMessageHeaderandQuestionSectionFormat.htm">DNS Message Header and Question Section Format</a>
	</caption>
	<thead>
		<tr>
			<th>Field Name</th>
			<th>Size (bytes)</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>ID</td>
			<td>2</td>
			<td>Identifier: A 16-bit identification field generated by the device that creates the DNS query. It is copied by the server into the response, so it can be used by that device to match that query to the corresponding reply received from a DNS server. This is used in a manner similar to how the Identifier field is used in many of the ICMP message types.</td>
		</tr>
		<tr>
			<td>QR</td>
			<td>1/8 (1 bit)</td>
			<td>Query/Response Flag: Differentiates between queries and responses. Set to 0 when the query is generated; changed to 1 when that query is changed to a response by a replying server.</td>
		</tr>
		<tr>
			<td>Opcode</td>
			<td>1/2 (4 bits)</td>
			<td>
			Operation Code: Specifies the type of query the message is carrying.
			This field is set the creator of the query and copied unchanged into
			the response.<br>
			<table border="1">
				<thead>
					<tr>
						<th>Opcode Value</th>
						<th>Opcode Name</th>
						<th>Description</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>0</td>
						<td>Query</td>
						<td>A standard query.</td>
					</tr>
					<tr>
						<td>1</td>
						<td>IQuery</td>
						<td>An inverse query; tdat is, finding a name from an IP address.</td>
					</tr>
					<tr>
						<td>2</td>
						<td>Status</td>
						<td>A server status request.</td>
					</tr>
					<tr>
						<td>3</td>
						<td>(reserved)</td>
						<td>Reserved, not used.</td>
					</tr>
					<tr>
						<td>4</td>
						<td>Notify</td>
						<td>
						Used by a primary (master, autdoritative) server to tell
						secondary servers that data for a zone has changed;
						so that they may request a zone transfer.
						</td>
					</tr>
					<tr>
						<td>5</td>
						<td>Update</td>
						<td>
						To implement dynamic DNS - records are added, deleted,
						or updated, selectively.
						</td>
					</tr>
				</tbody>
			</table>
			</td>
		</tr>
		<tr>
			<td>AA</td>
			<td>1/8 (1 bit)</td>
			<td>
			Authoritative Answer Flag: This bit is set to 1 in a response to indicate that the server that created the response is authoritative for the zone in which the domain name specified in the Question section is located. If it is 0, the response is non-authoritative.
			</td>
		</tr>
		<tr>
			<td>TC</td>
			<td>1/8 (1 bit)</td>
			<td>
Truncation Flag: When set to 1, indicates that the message was truncated due to its length being longer than the maximum permitted for the type of transport mechanism used. TCP doesn't have a length limit for messages, while UDP messages are limited to 512 bytes, so this bit being sent usually is an indication that the message was sent using UDP and was too long to fit. The client may need to establish a TCP session to get the full message. On the other hand, if the portion truncated was part of the Additional section, it may choose not to bother.
			</td>
		</tr>
		<tr>
			<td>RD</td>
			<td>1/8 (1 bit)</td>
			<td>
Recursion Desired: When set in a query, requests that the server receiving the query attempt to answer the query recursively, if the server supports recursive resolution. The value of this bit is not changed in the response			</td>
		</tr>
		<tr>
			<td>RA</td>
			<td>1/8 (1 bit)</td>
			<td>
Recursion Available: Set to 1 or cleared to 0 in a response to indicate whether the server creating the response supports recursive queries. This can then be noted by the device that sent the query for future use.
			</td>
		</tr>		
		<tr>
			<td>Z</td>
			<td>3/8 (3 bits)</td>
			<td>
Zero: Three reserved bits set to zero.
			</td>
		</tr>
		<tr>
			<td>Rcode</td>
			<td>1/2 (4 bits)</td>
			<td>
			Response Code: Set to zero in queries, then changed by the replying
			server in a response to convey the results of processing the query.
			This field is used to indicate if the query was answered successfully,
			or if some sort of error occurred.
			<br>
			<table border="1">
				<thead>
					<tr>
						<th>RCode Value</th>
						<th>Response Code</th>
						<th>Description</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>0</td>
						<td>No Error</td>
						<td>No error occurred.</td>
					</tr>
					<tr>
						<td>1</td>
						<td>Format Error</td>
						<td>The server was unable to respond to the query due
						to a problem with how it was constructed.
						</td>
					</tr>
					<tr>
						<td>2</td>
						<td>Server Failure</td>
						<td>The server was unable to respond to the query
						due to a problem with the server itself.
						</td>
					</tr>
					<tr>
						<td>3</td>
						<td>Name Error</td>
						<td>The name specified in the query does not exist
						in the domain. This code can be used by an authoritave
						server for a zone (since it knows all the objects and
						subdomains in a domain) or by a caching server that
						implements negative caching.
						</td>
					</tr>
					<tr>
						<td>4</td>
						<td>Not implemented</td>
						<td>
						The type of query received is not supported by the server.
						</td>
					</tr>
					<tr>
						<td>5</td>
						<td>Refused</td>
						<td>
							The server refused to process the query, generally for
							policy reasons and not technical ones. For example,
							certain types of operations, such as zone transfers,
							are restricted. The server will honor a zone transfer
							request only from certain devices.
						</td>
					</tr>	
					<tr>
						<td>6</td>
						<td>YX Domain</td>
						<td>A name exists when it should not.</td>
					</tr>
					<tr>
						<td>7</td>
						<td>YX RR Set</td>
						<td>A resource record set exists that should not.</td>
					</tr>
					<tr>
						<td>8</td>
						<td>NX RR Set</td>
						<td>A resource record set that should exist does not.</td>
					</tr>
					<tr>
						<td>9</td>
						<td>Not Auth</td>
						<td>The server receiving the query is not authoritative for the zone specified.</td>
					</tr>
					<tr>
						<td>10</td>
						<td>Not Zone</td>
						<td>A name specified in the message is not within the zone specified in the message.</td>
					</tr>
				</tbody>
			</table>
			</td>
		</tr>
		<tr>
			<td>QDCount</td>
			<td>2</td>
			<td>Question Count: Specifies the number of questions in the Question section of the message.</td>
		</tr>
		<tr>
			<td>ANCount</td>
			<td>2</td>
			<td>Answer Record Count: Specifies the number of resource records in the Answer section of the message.</td>
		</tr>
		<tr>
			<td>NSCount</td>
			<td>2</td>
			<td>Authority Record Count: Specifies the number of resource records in the Authority section of the message. NS stands for name server.</td>
		</tr>	
		<tr>
			<td>ARCount</td>
			<td>2</td>
			<td>Additional Record Count: Specifies the number of resource records in the Additional section of the message.</td>
		</tr>		
	<tbody>	
</table>
